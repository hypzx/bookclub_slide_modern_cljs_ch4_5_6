<!DOCTYPE html>
<html>
<head>
<title></title>
<!-- 2017-10-02 Mon 11:24 -->
<meta  charset="utf-8" />
<meta  htto-equiv="X-UA-Compatible" content="chrome=1" />
<meta  name="generator" content="Org-mode with org-ioslide" />
<meta  name="author" content="hyp" />


<!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
<!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--This one seems to work all the time, but really small on ipad-->
<!--<meta name="viewport" content="initial-scale=0.4">-->
<meta name="apple-mobile-web-app-capable" content="yes" />
<link rel="stylesheet" media="all" href="theme/css/default.css" />
<link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="theme/css/phone.css" />
<link rel="stylesheet" media="all" href="theme/css/small-icon.css" />
<base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
<script data-main="js/slides" src="js/require-1.0.8.min.js"></script>

   <script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>

<script src="js/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML,local/local" type="text/javascript"></script>
</head>
<body style="opacity: 0">
<slides class="layout-widescreen">
<slide class="title-slide segue nobackground">
       <aside class="gdbar"><img src="images/emacs-icon.png"></aside>
       <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
       <hgroup class="auto-fadein">
         <h1 data-config-title><!-- populated from slide_config.json --></h1>
         <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
         <p data-config-presenter><!-- populated from slide_config.json --></p>
       </hgroup>
    </slide>
  
<slide id="sec-" class=" segue dark quote nobackground" style="background-image: url(nil)">
<aside class="gdbar right bottom"><img src="images/emacs-icon.png"></aside><hgroup class="">
       <h2 class=" "><div id="outline-container-org406cf23" class="outline-2">
<h2 id="org406cf23">CH4</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="flexbox vleft auto-fadein" id="text-">


</article>
</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgc1eb3aa" class="outline-3">
<h3 id="orgc1eb3aa">login validate</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<ul>
<li>Server-side only validation</li>
<li>Client-side validation</li>
<li>Ajax in action</li>
</ul>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgc4a7937" class="outline-3">
<h3 id="orgc4a7937">login.html</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="html">
&lt;!-- login.html --&gt;
&lt;form action="login.php" method="post" id="loginForm"&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Login&lt;/legend&gt;
    &lt;!-- login.html 2 --&gt;

  &lt;/fieldset&gt;
&lt;/form&gt;</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org3228677" class="outline-3">
<h3 id="org3228677">login.html 2</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="html">
&lt;div&gt;
  &lt;label for="email"&gt;Email Address&lt;/label&gt;
  &lt;input type="email" name="email" id="email" required&gt;
&lt;/div&gt;

&lt;div&gt;
  &lt;label for="password"&gt;Password&lt;/label&gt;
  &lt;input type="password" name="password" id="password"
         required&gt;
&lt;/div&gt;

&lt;div&gt;
  &lt;label for="submit"&gt;&lt;/label&gt;
  &lt;input type="submit" value="Login &amp;rarr;" id="submit"&gt;
&lt;/div&gt;</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org93645d1" class="outline-3">
<h3 id="org93645d1">Immediate Feedback Development Environment (IFDE)</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<ul>
<li>Emacs + Cider
<ol>
<li>M-x <code>cider-jack-in</code></li>
<li><code>(def p (future (boot (dev)))</code></li>
</ol></li>

<li>run boot task
<ol>
<li>start terminal</li>
<li><code>boot dev</code></li>
<li>start another terminal</li>
<li><code>boot repl -c</code></li>
</ol></li>

<li>in clojure repl
<code>(start-repl)</code></li>
</ul>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgdeb21c2" class="outline-3">
<h3 id="orgdeb21c2">cider-boot-parameters</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
在 .dir-local 下設定:
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="emacs-lisp">
((nil
  (cider-boot-parameters . "repl -s -H :: wait dev")))</pre>

</div>
<p>
cider-jack-in 後會自己啟動
</p>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org161f580" class="outline-3">
<h3 id="org161f580">browser object in bREPL</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">javascript</th>
<th scope="col" class="left">bREPL</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">window</td>
<td class="left">js/window</td>
</tr>

<tr>
<td class="left">window.document</td>
<td class="left">js/document</td>
</tr>

<tr>
<td class="left">console</td>
<td class="left">js/console</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(js/console.log "Hello World!")</pre>

</div>

<p>
browser
</p>
<pre class="example">
&gt; Hello World!
</pre>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orga35a890" class="outline-3">
<h3 id="orga35a890">getElementById</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="javascript">
document.getElementById("loginForm");</pre>

</div>

<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(.getElementById js/document "loginForm")</pre>

</div>


</article>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgbb71990" class="outline-4">
<h4 id="orgbb71990">取得 HTML tag 的 property</h4>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
ClojureScript 中用 .- 這個 special form 取得 Html tag 的 property (屬性)，eg:
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(.-value (.getElementById js/document "email"))</pre>

</div>

<p>
要設定值到 Html tag property 上是用 clojure way &#x2013; set!
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(set! (.-value (.getElementById js/document "email")) "new@mail")</pre>

</div>

<p>
得到值 (String) 後可以用 count function 算字數
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(count (.-value (.getElementById js/document "email")))</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgd60ac42" class="outline-4">
<h4 id="orgd60ac42">coldnew 補充</h4>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
也可以用
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(aget  (.getElementById js/document "email") "value")</pre>

</div>


</article>

</slide>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org91187ce" class="outline-3">
<h3 id="org91187ce">validate-form</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
;; src/cljs/modern_cljs/login.cljs
(ns modern-cljs.login)

;; define the function to be attached to form submission event
(defn validate-form []
  ;; get email and password element from their ids in the HTML form
  (let [email (.getElementById js/document "email")
        password (.getElementById js/document "password")]
    (if (and (&gt; (count (.-value email)) 0)
             (&gt; (count (.-value password)) 0))
      true
      (do (js/alert "Please, complete the form!")
          false))))</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgf340325" class="outline-3">
<h3 id="orgf340325">doc &amp; source</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<ul>
<li>在 clojurescript 中同樣可以用 doc function 查 function 功能</li>
<li>也可以用 source function 查 function 的 source code</li>
</ul>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org5f2ca05" class="outline-3">
<h3 id="org5f2ca05">main.cljs.edn</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
clojurescript 下的 webpack (可能只有 js 功能)，在 html/js 下，只要在 :require 後的 vector 中加入要一起 build 的 namespace 即可:
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
{:require [modern-cljs.core modern-cljs.login modern-cljs.shopping]
 :compiler-options {:asset-path "js/main.out"}}</pre>

</div>

<p>
這樣會把 modern-cljs.core、modern-cljs.login、modern-cljs.shopping 這三個 namespace 的 function 一起 build 到 main 中。
</p>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgd087336" class="outline-3">
<h3 id="orgd087336">init</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
;; define the function to attach validate-form to onsubmit event of
;; the form
(defn init []
  ;; verify that js/document exists and that it has a getElementById
  ;; property
  (if (and js/document
           (.-getElementById js/document))
    ;; get loginForm by element id and set its onsubmit property to
    ;; our validate-form function
    (let [login-form (.getElementById js/document "loginForm")]
      (set! (.-onsubmit login-form) validate-form))))</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org19cd82d" class="outline-3">
<h3 id="org19cd82d">browser 的 window onload</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
在 ClojureScript 中要設定 onload 屬性的方式:
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(set! (.-onload js/window) init)</pre>

</div>
<p>
會同等於:
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="javascript">
window.onload = init;</pre>

</div>


</article>

</slide>

</slide>

</slide>
<slide id="sec-" class=" segue dark quote nobackground" style="background-image: url(nil)">
<aside class="gdbar right bottom"><img src="images/emacs-icon.png"></aside><hgroup class="">
       <h2 class=" "><div id="outline-container-org72abece" class="outline-2">
<h2 id="org72abece">CH5</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="flexbox vleft auto-fadein" id="text-">


</article>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgf55bd4d" class="outline-3">
<h3 id="orgf55bd4d">Domina</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
"a jQuery like library"
</p>

<p>
jQuery 的特點是 CSS Selecter，在 Domina 中也有:
</p>
<ul>
<li>xpath (domina.xpath)</li>
<li>sel (domina.css)</li>
</ul>

<p>
但也有 by-id, value, set-value! (domina.core) 這種方便使用的 function。
by-id, id 是 建立在 Google Closure Library 上的 function，它還會 check 參數是不是字串。
</p>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgfe7d4d7" class="outline-3">
<h3 id="orgfe7d4d7">howto</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
build.boot:
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojure">
(set-env!
 ...
 :dependencies '[
                 ;;...
                 [org.clojars.magomimmo/domina "2.0.0-SNAPSHOT"]
                 ])</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org92759c7" class="outline-3">
<h3 id="org92759c7">howto 2</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
在 bREPL 中使用:
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(require '[domina.core :refer [by-id value set-value!]])</pre>

</div>

<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
;; origin
(.-value (.getElementById js/document "email"))

;; after use domina
(value (by-id "email"))

;; origin
(set! (.-value (.getElementById js/document "email")) "test@mail")

;; after use domina
(set-value! (by-id "email") "test@mail")</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org81d2137" class="outline-3">
<h3 id="org81d2137">update login.cljs</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(ns modern-cljs.login
  (:require [domina.core :refer [by-id value]]))

(defn validate-form []
  (if (and (&gt; (count (value (by-id "email"))) 0)
           (&gt; (count (value (by-id "password"))) 0))
    true
    (do (js/alert "Please, complete the form!")
        false)))</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org5e8f472" class="outline-3">
<h3 id="org5e8f472">shopping</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
<a href="https://github.com/magomimmo/modern-cljs/blob/master/doc/second-edition/tutorial-05.md#pure-htmlcss-page">shopping.html</a>
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(ns modern-cljs.shopping
  (:require [domina.core :refer [by-id value set-value!]]))

(defn calculate []
  (let [quantity (value (by-id "quantity"))
        price (value (by-id "price"))
        tax (value (by-id "tax"))
        discount (value (by-id "discount"))]
    (set-value! (by-id "total") (-&gt; (* quantity price)
                                    (* (+ 1 (/ tax 100)))
                                    (- discount)
                                    (.toFixed 2)))
    false))
;; shopping 2</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org5bc3833" class="outline-3">
<h3 id="org5bc3833">shopping 2</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(defn init []
  (if (and js/document
           (.-getElementById js/document))
    (let [the-form (by-id "shoppingForm")]
      (set! (.-onsubmit the-form) calculate))))

(set! (.-onload js/window) init)</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org28d193b" class="outline-3">
<h3 id="org28d193b">main.cljs.edn</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
{:require [modern-cljs.core modern-cljs.login modern-cljs.shopping]
 :compiler-options {:asset-path "js/main.out"}}</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org49ecea4" class="outline-3">
<h3 id="org49ecea4">從 shopping.html 再回 login.html</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
會發現 (.-onsubmit (by-id "loginForm")) 被改成 shopping<sub>validate了</sub>
所以要在 bREPL 中:
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(require '[modern_cljs.login :as l] :reload)
(l/init)</pre>

</div>


</article>

</slide>

</slide>

</slide>
<slide id="sec-" class=" segue dark quote nobackground" style="background-image: url(nil)">
<aside class="gdbar right bottom"><img src="images/emacs-icon.png"></aside><hgroup class="">
       <h2 class=" "><div id="outline-container-orgea407a7" class="outline-2">
<h2 id="orgea407a7">CH6</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="flexbox vleft auto-fadein" id="text-">


</article>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org5cc3217" class="outline-3">
<h3 id="org5cc3217">Google Closure Compiler</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
在 build.boot 中 <code>:source-paths</code> 的設定會讓 GCSL 把該 path 下的 cljs compile，
</p>

<div class="org-src-container">

<pre class="prettyprint" data-lang="clojure">
(set-env!
 :source-paths #{"src/cljs"}
 :resource-paths #{"html"}

 ;; ....
 )
</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org7dfe5ba" class="outline-3">
<h3 id="org7dfe5ba">mutability</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
in <code>login.cljs</code> &amp; <code>shopping.cljs</code>
</p>
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
(set! (.-onload js/window) init)</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orga1b0806" class="outline-3">
<h3 id="orga1b0806">^:export</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="clojurescript">
;; the rest as before
(defn ^:export init []
  (if (and js/document
           (.-getElementById js/document))
    ;; get loginForm by element id and set its onsubmit property to
    ;; validate-form function
    (let [login-form (by-id "loginForm")]
      (set! (.-onsubmit login-form) validate-form))))

;; (set! (.-onload js/window) init)</pre>

</div>

<div class="org-src-container">

<pre class="prettyprint" data-lang="html">
&lt;script src="js/main.js"&gt;&lt;/script&gt;
&lt;script&gt;modern_cljs.login.init();&lt;/script&gt;</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-org1ef78b5" class="outline-3">
<h3 id="org1ef78b5">boot-cljs</h3>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
每次有增減 namespace 就要改 main.cljs.edn，太煩煩了，新的 boot-cljs 可以不用 
main.cljs.edn:
</p>
<ol>
<li>刪除 html/js</li>
<li>把 html 中的 &lt;script src="js/main.js"&gt;&lt;/script&gt; 改為 &lt;script src="main.js"&gt;&lt;/script&gt;</li>
</ol>


</article>

</slide>

</slide>


</slide>
<slide id="sec-" class=" thank-you-slide segue nobackground" style="background-image: url(nil)">
<aside class="gdbar right"><img src="images/emacs-icon.png"></aside><article class="flexbox vleft auto-fadein" id="text-">
<h2>
  <p>Thank You ˊ・ω・ˋ</p>
</h2>
<br>
<p class="auto-fadein" data-config-contact>
</p>
</article>

</slide>
<slide class="backdrop"></slide>
</slides> 
<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body> 

</html>
